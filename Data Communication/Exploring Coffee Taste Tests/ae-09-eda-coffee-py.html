<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Your name">

<title>AE 09: Explore coffee taste tests</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="ae-09-eda-coffee-py_files/libs/clipboard/clipboard.min.js"></script>
<script src="ae-09-eda-coffee-py_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="ae-09-eda-coffee-py_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="ae-09-eda-coffee-py_files/libs/quarto-html/popper.min.js"></script>
<script src="ae-09-eda-coffee-py_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ae-09-eda-coffee-py_files/libs/quarto-html/anchor.min.js"></script>
<link href="ae-09-eda-coffee-py_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ae-09-eda-coffee-py_files/libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ae-09-eda-coffee-py_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ae-09-eda-coffee-py_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ae-09-eda-coffee-py_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">AE 09: Explore coffee taste tests</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Your name </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="the-great-american-coffee-taste-test" class="level1">
<h1>The Great American Coffee Taste Test</h1>
<div id="packages" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> skimpy <span class="im">import</span> skim</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas.plotting <span class="im">import</span> scatter_matrix</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> missingno <span class="im">as</span> msno</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set random seed</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">167</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In October 2023, <a href="https://www.youtube.com/watch?v=bMOOQfeloH0">James Hoffmann</a> and coffee company <a href="https://cometeer.com/pages/the-great-american-coffee-taste-test">Cometeer</a> held the “Great American Coffee Taste Test” on YouTube, during which viewers were asked to fill out a survey about 4 coffees they ordered from Cometeer for the tasting. <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2024/2024-05-14/readme.md">Tidy Tuesday published the data set we are using</a>.</p>
<div id="import-coffee" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>coffee_survey <span class="op">=</span> pd.read_csv(<span class="st">"data/coffee_survey.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># partition into training and test sets</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>coffee_train, coffee_test <span class="op">=</span> train_test_split(coffee_survey, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">167</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It includes the following features:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 22%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">variable</th>
<th style="text-align: left;">class</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">submission_id</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Submission ID</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">What is your age?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cups</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">How many cups of coffee do you typically drink per day?</td>
</tr>
<tr class="even">
<td style="text-align: left;">where_drink</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Where do you typically drink coffee?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">brew</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">How do you brew coffee at home?</td>
</tr>
<tr class="even">
<td style="text-align: left;">brew_other</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">How else do you brew coffee at home?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">purchase</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">On the go, where do you typically purchase coffee?</td>
</tr>
<tr class="even">
<td style="text-align: left;">purchase_other</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Where else do you purchase coffee?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">favorite</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">What is your favorite coffee drink?</td>
</tr>
<tr class="even">
<td style="text-align: left;">favorite_specify</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Please specify what your favorite coffee drink is</td>
</tr>
<tr class="odd">
<td style="text-align: left;">additions</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Do you usually add anything to your coffee?</td>
</tr>
<tr class="even">
<td style="text-align: left;">additions_other</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">What else do you add to your coffee?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dairy</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">What kind of dairy do you add?</td>
</tr>
<tr class="even">
<td style="text-align: left;">sweetener</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">What kind of sugar or sweetener do you add?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">style</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Before today’s tasting, which of the following best described what kind of coffee you like?</td>
</tr>
<tr class="even">
<td style="text-align: left;">strength</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">How strong do you like your coffee?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">roast_level</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">What roast level of coffee do you prefer?</td>
</tr>
<tr class="even">
<td style="text-align: left;">caffeine</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">How much caffeine do you like in your coffee?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">expertise</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Lastly, how would you rate your own coffee expertise?</td>
</tr>
<tr class="even">
<td style="text-align: left;">coffee_a_bitterness</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Coffee A - Bitterness</td>
</tr>
<tr class="odd">
<td style="text-align: left;">coffee_a_acidity</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Coffee A - Acidity</td>
</tr>
<tr class="even">
<td style="text-align: left;">coffee_a_personal_preference</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Coffee A - Personal Preference</td>
</tr>
<tr class="odd">
<td style="text-align: left;">coffee_a_notes</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Coffee A - Notes</td>
</tr>
<tr class="even">
<td style="text-align: left;">coffee_b_bitterness</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Coffee B - Bitterness</td>
</tr>
<tr class="odd">
<td style="text-align: left;">coffee_b_acidity</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Coffee B - Acidity</td>
</tr>
<tr class="even">
<td style="text-align: left;">coffee_b_personal_preference</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Coffee B - Personal Preference</td>
</tr>
<tr class="odd">
<td style="text-align: left;">coffee_b_notes</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Coffee B - Notes</td>
</tr>
<tr class="even">
<td style="text-align: left;">coffee_c_bitterness</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Coffee C - Bitterness</td>
</tr>
<tr class="odd">
<td style="text-align: left;">coffee_c_acidity</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Coffee C - Acidity</td>
</tr>
<tr class="even">
<td style="text-align: left;">coffee_c_personal_preference</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Coffee C - Personal Preference</td>
</tr>
<tr class="odd">
<td style="text-align: left;">coffee_c_notes</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Coffee C - Notes</td>
</tr>
<tr class="even">
<td style="text-align: left;">coffee_d_bitterness</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Coffee D - Bitterness</td>
</tr>
<tr class="odd">
<td style="text-align: left;">coffee_d_acidity</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Coffee D - Acidity</td>
</tr>
<tr class="even">
<td style="text-align: left;">coffee_d_personal_preference</td>
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">Coffee D - Personal Preference</td>
</tr>
<tr class="odd">
<td style="text-align: left;">coffee_d_notes</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Coffee D - Notes</td>
</tr>
<tr class="even">
<td style="text-align: left;">prefer_abc</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Between Coffee A, Coffee B, and Coffee C which did you prefer?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">prefer_ad</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Between Coffee A and Coffee D, which did you prefer?</td>
</tr>
<tr class="even">
<td style="text-align: left;">prefer_overall</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Lastly, what was your favorite overall coffee?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wfh</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Do you work from home or in person?</td>
</tr>
<tr class="even">
<td style="text-align: left;">total_spend</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">In total, much money do you typically spend on coffee in a month?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">why_drink</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Why do you drink coffee?</td>
</tr>
<tr class="even">
<td style="text-align: left;">why_drink_other</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Other reason for drinking coffee</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taste</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Do you like the taste of coffee?</td>
</tr>
<tr class="even">
<td style="text-align: left;">know_source</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Do you know where your coffee comes from?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">most_paid</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">What is the most you’ve ever paid for a cup of coffee?</td>
</tr>
<tr class="even">
<td style="text-align: left;">most_willing</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">What is the most you’d ever be willing to pay for a cup of coffee?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">value_cafe</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Do you feel like you’re getting good value for your money when you buy coffee at a cafe?</td>
</tr>
<tr class="even">
<td style="text-align: left;">spent_equipment</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Approximately how much have you spent on coffee equipment in the past 5 years?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">value_equipment</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Do you feel like you’re getting good value for your money when you buy coffee at a cafe?</td>
</tr>
<tr class="even">
<td style="text-align: left;">gender</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Gender</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gender_specify</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Gender (please specify)</td>
</tr>
<tr class="even">
<td style="text-align: left;">education_level</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Education Level</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ethnicity_race</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Ethnicity/Race</td>
</tr>
<tr class="even">
<td style="text-align: left;">ethnicity_race_specify</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Ethnicity/Race (please specify)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">employment_status</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Employment Status</td>
</tr>
<tr class="even">
<td style="text-align: left;">number_children</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Number of Children</td>
</tr>
<tr class="odd">
<td style="text-align: left;">political_affiliation</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">Political Affiliation</td>
</tr>
</tbody>
</table>
<p>Our ultimate goal on a future assignment is to <strong>predict whether or not individuals like coffee D</strong> based on their survey responses and taste tests for coffees A-C.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> We will use a binary form of <code>coffee_d_personal_preference</code> variable as our target.</p>
<p>A quick skim of the data:</p>
<div id="skim" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(coffee_train.info())</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(coffee_train.describe())</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(coffee_train.isnull().<span class="bu">sum</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 3233 entries, 633 to 2881
Data columns (total 57 columns):
 #   Column                        Non-Null Count  Dtype  
---  ------                        --------------  -----  
 0   submission_id                 3233 non-null   object 
 1   age                           3208 non-null   object 
 2   cups                          3165 non-null   object 
 3   where_drink                   3176 non-null   object 
 4   brew                          2921 non-null   object 
 5   brew_other                    535 non-null    object 
 6   purchase                      550 non-null    object 
 7   purchase_other                24 non-null     object 
 8   favorite                      3189 non-null   object 
 9   favorite_specify              87 non-null     object 
 10  additions                     3171 non-null   object 
 11  additions_other               43 non-null     object 
 12  dairy                         1360 non-null   object 
 13  sweetener                     420 non-null    object 
 14  style                         3168 non-null   object 
 15  strength                      3131 non-null   object 
 16  roast_level                   3156 non-null   object 
 17  caffeine                      3140 non-null   object 
 18  expertise                     3154 non-null   float64
 19  coffee_a_bitterness           3048 non-null   float64
 20  coffee_a_acidity              3032 non-null   float64
 21  coffee_a_personal_preference  3041 non-null   float64
 22  coffee_a_notes                2068 non-null   object 
 23  coffee_b_bitterness           3033 non-null   float64
 24  coffee_b_acidity              3021 non-null   float64
 25  coffee_b_personal_preference  3028 non-null   float64
 26  coffee_b_notes                1967 non-null   object 
 27  coffee_c_bitterness           3022 non-null   float64
 28  coffee_c_acidity              3013 non-null   float64
 29  coffee_c_personal_preference  3022 non-null   float64
 30  coffee_c_notes                1902 non-null   object 
 31  coffee_d_bitterness           3022 non-null   float64
 32  coffee_d_acidity              3019 non-null   float64
 33  coffee_d_personal_preference  3019 non-null   float64
 34  coffee_d_notes                2073 non-null   object 
 35  prefer_abc                    3025 non-null   object 
 36  prefer_ad                     3018 non-null   object 
 37  prefer_overall                3024 non-null   object 
 38  wfh                           2841 non-null   object 
 39  total_spend                   2823 non-null   object 
 40  why_drink                     2867 non-null   object 
 41  why_drink_other               132 non-null    object 
 42  taste                         2862 non-null   object 
 43  know_source                   2858 non-null   object 
 44  most_paid                     2833 non-null   object 
 45  most_willing                  2820 non-null   object 
 46  value_cafe                    2810 non-null   object 
 47  spent_equipment               2812 non-null   object 
 48  value_equipment               2802 non-null   object 
 49  gender                        2825 non-null   object 
 50  gender_specify                10 non-null     object 
 51  education_level               2764 non-null   object 
 52  ethnicity_race                2748 non-null   object 
 53  ethnicity_race_specify        80 non-null     object 
 54  employment_status             2747 non-null   object 
 55  number_children               682 non-null    object 
 56  political_affiliation         2645 non-null   object 
dtypes: float64(13), object(44)
memory usage: 1.4+ MB
None
         expertise  coffee_a_bitterness  coffee_a_acidity  \
count  3154.000000          3048.000000       3032.000000   
mean      5.693088             2.127297          3.648747   
std       1.955330             0.942838          0.971537   
min       1.000000             1.000000          1.000000   
25%       5.000000             1.000000          3.000000   
50%       6.000000             2.000000          4.000000   
75%       7.000000             3.000000          4.000000   
max      10.000000             5.000000          5.000000   

       coffee_a_personal_preference  coffee_b_bitterness  coffee_b_acidity  \
count                   3041.000000          3033.000000       3021.000000   
mean                       3.317330             3.013848          2.226084   
std                        1.189424             0.990958          0.866328   
min                        1.000000             1.000000          1.000000   
25%                        2.000000             2.000000          2.000000   
50%                        3.000000             3.000000          2.000000   
75%                        4.000000             4.000000          3.000000   
max                        5.000000             5.000000          5.000000   

       coffee_b_personal_preference  coffee_c_bitterness  coffee_c_acidity  \
count                   3028.000000          3022.000000       3013.000000   
mean                       3.072655             3.085043          2.358447   
std                        1.116299             0.998367          0.919191   
min                        1.000000             1.000000          1.000000   
25%                        2.000000             2.000000          2.000000   
50%                        3.000000             3.000000          2.000000   
75%                        4.000000             4.000000          3.000000   
max                        5.000000             5.000000          5.000000   

       coffee_c_personal_preference  coffee_d_bitterness  coffee_d_acidity  \
count                   3022.000000          3022.000000       3019.000000   
mean                       3.066512             2.155526          3.875787   
std                        1.128551             1.070952          1.000070   
min                        1.000000             1.000000          1.000000   
25%                        2.000000             1.000000          3.000000   
50%                        3.000000             2.000000          4.000000   
75%                        4.000000             3.000000          5.000000   
max                        5.000000             5.000000          5.000000   

       coffee_d_personal_preference  
count                   3019.000000  
mean                       3.395495  
std                        1.447305  
min                        1.000000  
25%                        2.000000  
50%                        4.000000  
75%                        5.000000  
max                        5.000000  
submission_id                      0
age                               25
cups                              68
where_drink                       57
brew                             312
brew_other                      2698
purchase                        2683
purchase_other                  3209
favorite                          44
favorite_specify                3146
additions                         62
additions_other                 3190
dairy                           1873
sweetener                       2813
style                             65
strength                         102
roast_level                       77
caffeine                          93
expertise                         79
coffee_a_bitterness              185
coffee_a_acidity                 201
coffee_a_personal_preference     192
coffee_a_notes                  1165
coffee_b_bitterness              200
coffee_b_acidity                 212
coffee_b_personal_preference     205
coffee_b_notes                  1266
coffee_c_bitterness              211
coffee_c_acidity                 220
coffee_c_personal_preference     211
coffee_c_notes                  1331
coffee_d_bitterness              211
coffee_d_acidity                 214
coffee_d_personal_preference     214
coffee_d_notes                  1160
prefer_abc                       208
prefer_ad                        215
prefer_overall                   209
wfh                              392
total_spend                      410
why_drink                        366
why_drink_other                 3101
taste                            371
know_source                      375
most_paid                        400
most_willing                     413
value_cafe                       423
spent_equipment                  421
value_equipment                  431
gender                           408
gender_specify                  3223
education_level                  469
ethnicity_race                   485
ethnicity_race_specify          3153
employment_status                486
number_children                 2551
political_affiliation            588
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="examining-continuous-variables" class="level1">
<h1>Examining continuous variables</h1>
<p><strong>Your turn:</strong> Examine <code>expertise</code> using a histogram and appropriate <code>binwidth</code>. Describe the features of this variable.</p>
<div id="expertise" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Add response here.</em></p>
<p><strong>Your turn:</strong> Each coffee has three numeric ratings by the respondents: bitterness, acidity, and personal preference. Create a histogram for each of these characteristics, faceted by coffee type. What do you notice?</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Wrangling the data for easier visualization">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Wrangling the data for easier visualization
</div>
</div>
<div class="callout-body-container callout-body">
<p>The original structure of the data is one column for each coffee for each characteristic. You could create separate graphs for each of the 12 columns, but that seems like a lot of work. Instead, consider using the <code>pivot_longer()</code> function to restructure the data to one row per coffee per characteristic. This will make it easier to create the faceted histograms.</p>
<div id="cell-coffee-pivot-demo" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select columns starting with "coffee" but not ending with "notes"</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>coffee_cols <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> coffee_train.columns </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>               <span class="cf">if</span> col.startswith(<span class="st">'coffee_'</span>) <span class="kw">and</span> <span class="kw">not</span> col.endswith(<span class="st">'_notes'</span>)]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data using melt (pandas equivalent of pivot_longer)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>coffee_long <span class="op">=</span> coffee_train[coffee_cols].melt(</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    var_name<span class="op">=</span><span class="st">'coffee_measure'</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    value_name<span class="op">=</span><span class="st">'value'</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the column names to separate coffee type and measure</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>coffee_long[[<span class="st">'coffee'</span>, <span class="st">'measure'</span>]] <span class="op">=</span> coffee_long[<span class="st">'coffee_measure'</span>].<span class="bu">str</span>.replace(<span class="st">'coffee_'</span>, <span class="st">''</span>).<span class="bu">str</span>.split(<span class="st">'_'</span>, n<span class="op">=</span><span class="dv">1</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the original combined column and reorder</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>coffee_long <span class="op">=</span> coffee_long[[<span class="st">'coffee'</span>, <span class="st">'measure'</span>, <span class="st">'value'</span>]]</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>coffee_long</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="coffee-pivot-demo" class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">coffee</th>
<th data-quarto-table-cell-role="th">measure</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>a</td>
<td>bitterness</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>a</td>
<td>bitterness</td>
<td>3.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>a</td>
<td>bitterness</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>a</td>
<td>bitterness</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>a</td>
<td>bitterness</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38791</td>
<td>d</td>
<td>personal_preference</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">38792</td>
<td>d</td>
<td>personal_preference</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38793</td>
<td>d</td>
<td>personal_preference</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">38794</td>
<td>d</td>
<td>personal_preference</td>
<td>5.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38795</td>
<td>d</td>
<td>personal_preference</td>
<td>4.0</td>
</tr>
</tbody>
</table>

<p>38796 rows × 3 columns</p>
</div>
</div>
</div>
</div>
</div>
<div id="coffee-characteristics" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Add response here.</em></p>
</section>
<section id="examining-categorical-variables" class="level1">
<h1>Examining categorical variables</h1>
<p><strong>Your turn:</strong> Examine <code>prefer_overall</code> graphically. Record your observations.</p>
<div id="preferred-brew" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Add response here.</em></p>
<p><strong>Your turn:</strong> Examine <code>cups</code>, <code>brew</code>, and <code>roast_level</code>. Record your observations, in particular how you might need to handle these variables in the modeling stage.</p>
<div id="cups" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Add response here.</em></p>
<div id="brew" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Add response here.</em></p>
<div id="roast" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Add response here.</em></p>
</section>
<section id="making-comparisons" class="level1">
<h1>Making comparisons</h1>
<p><strong>Your turn:</strong> Compare the relationship between <code>coffee_d_personal_preference</code> and the respondents’ preferred roast levels. Use a <strong>proportional bar chart</strong> to visualize the relationship.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Use <code>position='fill'</code> with <code>geom_bar()</code> to automatically calculate percentages for the chart.</p>
</div>
</div>
<div id="pref-by-roast" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Add response here.</em></p>
<p><strong>Your turn:</strong> Examine the relationship between the respondents’ numeric ratings for acidity, bitterness, and personal preference for each of the four coffees and compare to their overall preference. Record your observations.</p>
<p><em>Add response here.</em></p>
</section>
<section id="data-quality" class="level1">
<h1>Data quality</h1>
<section id="missingness" class="level2">
<h2 class="anchored" data-anchor-id="missingness">Missingness</h2>
<p><strong>Demonstration:</strong> Use <a href="https://github.com/ResidentMario/missingno"><code>missingno</code></a> to visualize missingness patterns in the data set.</p>
<div id="cell-py-missingness-1" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick glance of missingness by row/column order</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>msno.matrix(coffee_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ae-09-eda-coffee-py_files/figure-html/py-missingness-1-output-1.png" id="py-missingness-1" width="1980" height="784" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-py-missingness-2" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns based on % missing</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>msno.matrix(coffee_train.loc[:, coffee_train.isnull().<span class="bu">sum</span>().sort_values(ascending<span class="op">=</span><span class="va">False</span>).index])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ae-09-eda-coffee-py_files/figure-html/py-missingness-2-output-1.png" id="py-missingness-2" width="1980" height="784" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-py-missingness-3" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cluster rows based on similarity in missingness patterns</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>msno.dendrogram(coffee_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ae-09-eda-coffee-py_files/figure-html/py-missingness-3-output-1.png" id="py-missingness-3" width="2208" height="1237" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>Your turn:</strong> Record your observations on the missingness patterns in the data set. What variables have high missingness? Is this surprising? What might you do to variables or observations with high degrees of missingness?</p>
<p><em>Add response here.</em></p>
</section>
<section id="outliers" class="level2">
<h2 class="anchored" data-anchor-id="outliers">Outliers</h2>
<p><strong>Demonstration:</strong> Generate a scatterplot matrix for all the numeric variables in the data set.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div id="num-outliers" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get all numeric columns</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>numeric_cols <span class="op">=</span> coffee_train.select_dtypes(include<span class="op">=</span>[np.number]).columns</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatterplot matrix using pandas</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span>))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>scatter_matrix(coffee_train[numeric_cols], alpha<span class="op">=</span><span class="fl">0.6</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">15</span>), diagonal<span class="op">=</span><span class="st">'hist'</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ae-09-eda-coffee-py_files/figure-html/num-outliers-output-1.png" id="num-outliers-1" width="1176" height="1155" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="ae-09-eda-coffee-py_files/figure-html/num-outliers-output-2.png" id="num-outliers-2" width="1179" height="1175" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>Your turn:</strong> Examine the distribution of roast/gender and roast/cups. Describe the patterns you see and anything that is of particular interest given the model we will estimate.</p>
<div id="roast-gender" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="roast-cups" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add code here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Add response here.</em></p>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Think of it as a recommendation engine for future customers who do a survey and taste test for three varieties of coffee.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Not particularly helpful for this dataset, but a good practice to get into.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>